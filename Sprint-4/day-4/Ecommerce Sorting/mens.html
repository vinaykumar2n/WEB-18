<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mens</title>
    <link rel="stylesheet" href="navbarstyles.css">
    <link rel="stylesheet" href="mens,womens,homestyles.css">
    <script src="https://kit.fontawesome.com/06a1a96c9d.js" crossorigin="anonymous"></script>

</head>
<body>
    <div id="navbar">
        <div>Reebok</div>
        <div>
            <div id="homepage"><a href="homepage.html">Home</a></div>
            <div id="menspage"><a href="mens.html">Mens</a></div>
            <div id="womenspage"><a href="womens.html">Womens</a></div>
            <div id="username"><i class="fa-solid fa-user"></i><span></span></div>
            <div id="cart"><a href="cart.html">Cart</a></div>
        </div>
    </div>
    <div id="sorting">
        <!-- price sorting -->
        <select id="sortprice" onchange="handlepricesort()">
            <option value="none">Sort by price</option>
            <option value="htl">High To Low</option>
            <option value="lth">Low to High</option>
        </select>
        <!-- names sorting -->
        <select id="sortnames" onchange="handlenamesort()">
            <option value="none">Sort by name</option>
            <option value="asc">Ascending</option>
            <option value="des">Descending</option>
        </select>
        <select id="sortbrand" onchange="handlebrandsort()">
            <option value="none">Select category</option>
            <option value="casual">casual</option>
            <option value="party wear">party wear</option>
            <option value="ethinic wear">ethnic wear</option>
          </select>
    </div>
    <div id="container"></div>
</body>
</html>
<script src="data_from_backend.js"></script>
<script>
    var signupDetails=JSON.parse(localStorage.getItem("signupDetails"))
    var mensData=JSON.parse(localStorage.getItem("mensData"))

    document.querySelector("#username>span").innerText=signupDetails.name

    var cartData=JSON.parse(localStorage.getItem("cartData")) || []

    display(mensData)

    function handlenamesort(){
      var selected= document.querySelector("#sortnames").value
      if(selected == "asc")
      {
        mensData.sort(function(a,b){
          var x= a.name.toUpperCase();
          var y= b.name.toUpperCase()
          if(x>y)
          {
            return 1;
          }
          if(x<y)
          {
            return -1
          }
          return 0;

        })
        display(mensData)
      }
      if(selected == "des")
      {
        mensData.sort(function(a,b){
          var x= a.name.toUpperCase();
          var y= b.name.toUpperCase()
          if(x>y)
          {
            return -1;
          }
          if(x<y)
          {
            return 1
          }
          return 0;

        })
        display(mensData)
      }
      if(selected=="none")
      {
        window.location.reload()
      }
    }

    function handlepricesort(){
      var selected=document.querySelector("#sortprice").value;
      if(selected=="lth")
      {
        mensData.sort(function(a,b){
          return a.price-b.price;
        })
        display(mensData)
      }
      if(selected=="htl")
      {
        mensData.sort(function(a,b){
          return b.price - a.price
        })
        display(mensData)
      }
      if(selected=="none"){
        window.location.reload();
      }
    }
    function handlebrandsort(){
      var selected=document.querySelector("#sortbrand").value;
      console.log(selected)
      if(selected=="none")
      {
        window.location.reload();
      }
      else{
        var filtered=mensData.filter(function(el,i){
          return selected==el.brand
        })
        display(filtered)
      }
    }

    function display(items){
        document.querySelector("#container").innerHTML=""
        items.map(function(el){
            var box=document.createElement("div");

            var boximage=document.createElement("img")
            boximage.setAttribute("src",el.image_url)

            var boxname=document.createElement("div")
            boxname.setAttribute("id","nameofpro")
            var htag=document.createElement("h4")
            htag.setAttribute("id","prodname")
            htag.innerText=el.name;
            
            boxname.append(htag)
            var brandname=document.createElement("h5");
            brandname.innerText=el.brand;
            

            var boxpricediv=document.createElement("div");
            boxpricediv.style.display="flex"
            
            var boxprice=document.createElement("p");
            boxprice.innerHTML=`Rs.`
            var amount=document.createElement("span");
            amount.innerText=el.price
            boxprice.append(amount)

            var strike=document.createElement("p");
            strike.innerHTML=`Rs.`;
            strike.style.textDecoration="line-through"
            strike.style.marginLeft="30px"

            var st=document.createElement("span");
            st.innerText=el.strikedoffprice;
            strike.append(st)

            var cartbtn=document.createElement("button");
            cartbtn.setAttribute("id","cartbutton")
            cartbtn.innerText="Add to cart"
            cartbtn.addEventListener("click",function(){
                cartfunction(el);
            })
            boxpricediv.append(boxprice,strike);

            box.append(boximage,boxname,brandname,boxpricediv,cartbtn);

            document.querySelector("#container").append(box);
        })
        
    }
var c;
    function cartfunction(el){
        c=cartData.find(ele => el.uniqueid==ele.uniqueid)
        console.log(c)
        if(c)
        {
            alert("Already added to cart")
        }
        else{
            cartData.push(el);
        localStorage.setItem("cartData",JSON.stringify(cartData)) 
        }   
    }   
</script>